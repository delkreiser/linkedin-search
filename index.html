<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LinkedIn Job Search Tool</title>
  <link rel="icon" type="image/x-icon" href="img/favicon.ico">
  <style>
    * { box-sizing: border-box; }
    
    :root {
      --bg-primary: #e9ecef;
      --bg-secondary: #f5f5f5;
      --text-primary: #333;
      --text-secondary: #666;
      --text-placeholder: #aaa;
      --border-color: #ccc;
      --linkedin-blue: #0073b1;
      --linkedin-blue-hover: #005582;
      --shadow: rgba(0,0,0,0.1);
      --toggle-off: #ccc;
      --success: #28a745;
      --success-hover: #218838;
    }
    
    [data-theme="dark"] {
      --bg-primary: #1a1a1a;
      --bg-secondary: #2d2d2d;
      --text-primary: #e0e0e0;
      --text-secondary: #b0b0b0;
      --text-placeholder: #666;
      --border-color: #444;
      --linkedin-blue: #0a66c2;
      --linkedin-blue-hover: #004182;
      --shadow: rgba(0,0,0,0.3);
      --toggle-off: #555;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      transition: background-color 0.3s, color 0.3s;
    }
    
    .container {
      background-color: var(--bg-secondary);
      padding: 0;
      border-radius: 12px;
      box-shadow: 0 4px 12px var(--shadow);
      width: 100%;
      max-width: 600px;
      margin-bottom: 20px;
      overflow: hidden;
      transition: background-color 0.3s;
    }
    
    .header-img {
      width: 100%;
      display: block;
      max-height: 200px;
      object-fit: cover;
    }
    
    /* Header Banner Styles */
    .header-banner {
      background: linear-gradient(135deg, #0073b1, #005582);
      padding: 40px 20px;
      text-align: center;
    }
    
    .header-title {
      color: white;
      font-size: 2em;
      font-weight: 700;
      margin: 0;
      letter-spacing: -0.5px;
    }
    
    @media (max-width: 600px) {
      .header-banner {
        padding: 30px 15px;
      }
      .header-title {
        font-size: 1.5em;
      }
    }
    
    .content {
      padding: 25px;
    }
    
    .header-controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      align-items: stretch;
    }
    
    .icon-button {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 0.85em;
      color: var(--text-primary) !important;
      transition: all 0.2s;
      flex: 1;
      min-width: 80px;
      white-space: nowrap;
    }
    
    .icon-button:hover {
      background: var(--linkedin-blue);
      color: white !important;
      border-color: var(--linkedin-blue);
    }
    
    .icon-button.profile-btn {
      background: var(--success);
      color: white;
      border-color: var(--success);
      font-weight: 600;
      flex: 2;
      min-width: 150px;
    }
    
    .icon-button.profile-btn:hover {
      background: var(--success-hover);
    }
    
    .profile-banner {
      background: linear-gradient(135deg, rgba(0, 115, 177, 0.1), rgba(0, 115, 177, 0.05));
      border-left: 4px solid var(--linkedin-blue);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .profile-banner-content {
      flex: 1;
    }
    
    .profile-banner-title {
      font-weight: 600;
      color: var(--linkedin-blue);
      font-size: 0.9em;
      margin-bottom: 5px;
    }
    
    .profile-banner-details {
      font-size: 0.85em;
      color: var(--text-secondary);
    }
    
    .profile-banner-close {
      background: none;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      font-size: 1.3em;
      padding: 5px 10px;
      transition: color 0.2s;
    }
    
    .profile-banner-close:hover {
      color: var(--text-primary);
    }
    
    .section-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.95em;
      margin-bottom: 5px;
    }
    
    .section {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-top: 12px;
      font-size: 0.9em;
      color: var(--text-secondary);
    }
    
    input, select {
      margin-top: 5px;
      padding: 10px 12px;
      font-size: 1em;
      width: 100%;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-secondary);
      color: var(--text-primary);
      transition: all 0.2s;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: var(--linkedin-blue);
      box-shadow: 0 0 0 3px rgba(0, 115, 177, 0.1);
    }
    
    ::placeholder { 
      color: var(--text-placeholder);
    }
    
    option[disabled] { 
      color: var(--text-placeholder);
    }
    
    #customGeoDiv { 
      margin-top: 10px;
      display: none;
    }
    
    .collapsible-section {
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 15px;
      overflow: hidden;
    }
    
    .collapsible-header {
      background: var(--bg-primary);
      padding: 12px 15px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
      transition: background-color 0.2s;
    }
    
    .collapsible-header:hover {
      opacity: 0.9;
    }
    
    .collapsible-header .arrow {
      transition: transform 0.3s;
    }
    
    .collapsible-header.active .arrow {
      transform: rotate(180deg);
    }
    
    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      padding: 0 15px;
    }
    
    .collapsible-content.active {
      max-height: 800px;
      padding: 15px;
    }
    
    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }
    
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      border-radius: 6px;
      transition: background-color 0.2s;
    }
    
    .checkbox-item:hover {
      background-color: var(--bg-primary);
    }
    
    .checkbox-item input[type="checkbox"] {
      width: auto;
      margin: 0;
      cursor: pointer;
    }
    
    .checkbox-item label {
      margin: 0;
      cursor: pointer;
      font-size: 0.85em;
    }
    
    .toggle-table {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }
    
    .toggle-cell {
      display: flex;
      align-items: center;
    }
    
    .toggle-label {
      font-size: 0.85em;
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      gap: 8px;
    }
    
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--toggle-off);
      transition: .3s;
      border-radius: 24px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: var(--linkedin-blue);
    }
    
    input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    /* Distance Range Slider */
    .slider-container {
      margin-top: 10px;
      padding: 10px 0;
    }
    
    .slider-value {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .slider-value-label {
      font-size: 0.95em;
      font-weight: 500;
      transition: color 0.3s;
    }
    
    .range-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #ccc;
      outline: none;
      transition: background 0.1s;
      margin: 15px 0;
    }
    
    .range-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #e0e0e0;
      border: 5px solid var(--linkedin-blue);
      cursor: pointer;
      box-shadow: 0 2px 8px var(--shadow);
      transition: transform 0.2s;
      margin-top: 0;
    }
    
    .range-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 3px 12px var(--shadow);
    }
    
    .range-slider::-moz-range-thumb {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #e0e0e0;
      border: 5px solid var(--linkedin-blue);
      cursor: pointer;
      box-shadow: 0 2px 8px var(--shadow);
      transition: transform 0.2s;
    }
    
    .range-slider::-moz-range-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 3px 12px var(--shadow);
    }
    
    .range-slider::-moz-range-track {
      height: 6px;
      background: transparent;
      border-radius: 3px;
    }
    
    .slider-labels {
      position: relative;
      width: 100%;
      margin-top: 5px;
      font-size: 0.75em;
      color: var(--text-secondary);
      height: 15px;
    }
    
    .slider-labels span {
      white-space: nowrap;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 25px;
    }
    
    button {
      flex: 1;
      padding: 12px 20px;
      font-size: 1em;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      font-weight: 500;
      transition: all 0.2s;
    }
    
    .primary-btn {
      background-color: var(--linkedin-blue);
      color: #fff;
    }
    
    .primary-btn:hover {
      background-color: var(--linkedin-blue-hover);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px var(--shadow);
    }
    
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      animation: fadeIn 0.2s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-content {
      background-color: var(--bg-secondary);
      margin: 3% auto;
      padding: 0;
      border-radius: 12px;
      width: 90%;
      max-width: 550px;
      box-shadow: 0 8px 24px var(--shadow);
      animation: slideIn 0.3s;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
    }
    
    @keyframes slideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .modal-header {
      padding: 20px 25px;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }
    
    .modal-header h2 {
      margin: 0;
      font-size: 1.3em;
      color: var(--text-primary);
    }
    
    .close {
      color: var(--text-secondary);
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.2s;
      line-height: 1;
    }
    
    .close:hover {
      color: var(--text-primary);
    }
    
    .modal-body {
      padding: 25px;
      overflow-y: auto;
      flex: 1;
    }
    
    .modal-footer {
      padding: 15px 25px;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-shrink: 0;
    }
    
    .modal-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      transition: all 0.2s;
      font-weight: 500;
      white-space: nowrap;
    }
    
    .modal-btn-primary {
      background: var(--linkedin-blue);
      color: white;
    }
    
    .modal-btn-primary:hover {
      background: var(--linkedin-blue-hover);
    }
    
    .modal-btn-success {
      background: var(--success);
      color: white;
    }
    
    .modal-btn-success:hover {
      background: var(--success-hover);
    }
    
    .modal-btn-secondary {
      background: transparent;
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .modal-btn-secondary:hover {
      background: var(--bg-primary);
    }
    
    /* Profile List */
    .profile-list {
      margin-bottom: 20px;
    }
    
    .profile-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      margin: 10px 0;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .profile-item:hover {
      border-color: var(--linkedin-blue);
      transform: translateX(5px);
    }
    
    .profile-item.active {
      border-color: var(--linkedin-blue);
      background: rgba(0, 115, 177, 0.05);
    }
    
    .profile-info {
      flex: 1;
    }
    
    .profile-name {
      font-weight: 600;
      font-size: 1em;
      color: var(--text-primary);
      margin-bottom: 5px;
    }
    
    .profile-details {
      font-size: 0.8em;
      color: var(--text-secondary);
    }
    
    .profile-actions {
      display: flex;
      gap: 8px;
    }
    
    .profile-action-btn {
      background: transparent;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 0.9em;
      transition: background-color 0.2s;
    }
    
    .profile-action-btn.load {
      color: var(--linkedin-blue);
    }
    
    .profile-action-btn.load:hover {
      background: rgba(0, 115, 177, 0.1);
    }
    
    .profile-action-btn.edit {
      color: #ffa500;
    }
    
    .profile-action-btn.edit:hover {
      background: rgba(255, 165, 0, 0.1);
    }
    
    .profile-action-btn.delete {
      color: #dc3545;
    }
    
    .profile-action-btn.delete:hover {
      background: rgba(220, 53, 69, 0.1);
    }
    
    /* Quick Action Buttons */
    .quick-search-section {
      margin-bottom: 25px;
    }
    
    .quick-search-header {
      font-size: 0.95em;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .quick-search-tip {
      font-size: 0.85em;
      color: var(--text-secondary);
      margin-top: 12px;
      line-height: 1.5;
      font-style: italic;
    }
    
    .quick-search-divider {
      height: 1px;
      background: linear-gradient(to right, var(--border-color), transparent);
      margin-top: 20px;
    }
    
    /* Settings Toggle Section */
    .settings-toggle-section {
      margin-bottom: 20px;
    }
    
    .settings-summary {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 15px;
    }
    
    .settings-summary-content {
      flex: 1;
    }
    
    .summary-text {
      color: var(--text-primary);
      font-size: 0.95em;
      font-weight: 500;
    }
    
    .settings-edit-btn {
      background: var(--linkedin-blue);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 500;
      white-space: nowrap;
      transition: all 0.2s;
    }
    
    .settings-edit-btn:hover {
      background: var(--linkedin-blue-hover);
      transform: translateY(-1px);
    }
    
    .settings-expanded {
      /* Shown by default, hidden when summary is shown */
    }
    
    .settings-collapse-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      margin-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .collapse-icon {
      font-size: 0.8em;
      color: var(--text-secondary);
      transition: transform 0.2s;
    }
    
    .settings-collapsed .collapse-icon {
      transform: rotate(180deg);
    }
    
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }
    
    .quick-action-btn {
      aspect-ratio: 1;
      padding: 20px 15px;
      border: 2px solid var(--linkedin-blue);
      background: var(--bg-primary);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      gap: 8px;
      color: var(--text-primary);
    }
    
    .quick-action-btn:hover {
      background: var(--linkedin-blue);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px var(--shadow);
    }
    
    .quick-action-icon {
      font-size: 1.8em;
      pointer-events: none;
    }
    
    .quick-action-label {
      font-size: 0.85em;
      font-weight: 600;
      line-height: 1.2;
      color: inherit;
      pointer-events: none;
    }
    
    @media (min-width: 768px) {
      .quick-actions {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }
    
    .empty-state-icon {
      font-size: 3.5em;
      margin-bottom: 15px;
    }
    
    /* Questionnaire Styles */
    .questionnaire-step {
      display: none;
    }
    
    .questionnaire-step.active {
      display: block;
      animation: fadeInUp 0.3s;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .question-title {
      font-size: 1.1em;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 15px;
    }
    
    .progress-bar {
      width: 100%;
      height: 4px;
      background: var(--border-color);
      border-radius: 2px;
      margin-bottom: 25px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: var(--linkedin-blue);
      transition: width 0.3s;
    }
    
    .option-card {
      padding: 15px;
      margin: 10px 0;
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .option-card:hover {
      border-color: var(--linkedin-blue);
      background: rgba(0, 115, 177, 0.05);
    }
    
    .option-card.selected {
      border-color: var(--linkedin-blue);
      background: rgba(0, 115, 177, 0.1);
    }
    
    .option-radio {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      flex-shrink: 0;
    }
    
    .option-card.selected .option-radio {
      border-color: var(--linkedin-blue);
      background: var(--linkedin-blue);
    }
    
    .option-card.selected .option-radio::after {
      content: '‚úì';
      color: white;
      font-size: 0.8em;
      font-weight: bold;
    }
    
    .option-text {
      flex: 1;
      font-size: 0.95em;
      color: var(--text-primary);
    }
    
    .location-input-container {
      position: relative;
    }
    
    .location-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      margin-top: 5px;
      max-height: 200px;
      overflow-y: auto;
      box-shadow: 0 4px 12px var(--shadow);
      z-index: 100;
      display: none;
    }
    
    .location-suggestions.active {
      display: block;
    }
    
    .location-suggestion-item {
      padding: 10px 15px;
      cursor: pointer;
      transition: background-color 0.2s;
      font-size: 0.9em;
    }
    
    .location-suggestion-item:hover {
      background: var(--bg-primary);
    }
    
    @media (max-width: 600px) {
      .content { padding: 20px; }
      .checkbox-group { grid-template-columns: 1fr; }
      .toggle-table { grid-template-columns: 1fr; }
      .button-container { flex-direction: column; }
      .header-controls { 
        justify-content: center;
        gap: 8px;
      }
      .icon-button { 
        min-width: auto;
        font-size: 0.8em;
        padding: 6px 8px;
      }
      .icon-button.profile-btn {
        flex: 0 0 100%;
        width: 100%;
      }
    }
  </style>
</head>
<body data-theme="light">
  
  <div class="container">
    <!-- Header Banner -->
    <div class="header-banner">
      <h1 class="header-title">LinkedIn Job Search Tool</h1>
    </div>
    
    <div class="content">
      <!-- Control Buttons -->
      <div class="header-controls">
        <button id="profilesButton" class="icon-button profile-btn" onclick="openProfileModal()">üë§ Create a Profile</button>
        <button class="icon-button" onclick="toggleTheme()">üåì Dark Mode</button>
        <button class="icon-button" onclick="clearForm()">üîÑ Clear</button>
      </div>
      
      <!-- Active Profile Banner -->
      <div id="profileBanner" class="profile-banner" style="display: none;">
        <div class="profile-banner-content">
          <div class="profile-banner-title">üéØ Active Profile</div>
          <div id="profileBannerDetails" class="profile-banner-details"></div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center;">
          <button onclick="editActiveProfile()" style="background: none; border: none; color: #ffa500; cursor: pointer; font-size: 1.1em; padding: 5px 10px; transition: opacity 0.2s;" onmouseover="this.style.opacity='0.7'" onmouseout="this.style.opacity='1'">‚úèÔ∏è</button>
          <button class="profile-banner-close" onclick="clearProfile()">√ó</button>
        </div>
      </div>
      
      <!-- Quick Searches Section -->
      <div class="quick-search-section">
        <div class="quick-search-header">‚ö° Quick Searches</div>
        <div class="quick-actions">
          <button class="quick-action-btn" onclick="quickSearch('8h')">
            <div class="quick-action-icon">üî•</div>
            <div class="quick-action-label">Past 8 Hours</div>
          </button>
          <button class="quick-action-btn" onclick="quickSearch('24h')">
            <div class="quick-action-icon">‚è∞</div>
            <div class="quick-action-label">Past 24 Hours</div>
          </button>
          <button class="quick-action-btn" onclick="quickSearch('under10')">
            <div class="quick-action-icon">üë•</div>
            <div class="quick-action-label">Under 10 Applicants</div>
          </button>
          <button class="quick-action-btn" onclick="quickSearch('topApplicant')">
            <div class="quick-action-icon">‚≠ê</div>
            <div class="quick-action-label">Top Applicant</div>
          </button>
        </div>
        <div class="quick-search-tip">
          Recruiters focus on early applicants. Use these quick searches to find fresh postings and apply fast.
        </div>
        <div class="quick-search-divider"></div>
      </div>
      
      <!-- Keywords Section -->
      <div class="section">
        <label class="section-title" for="keywords">Job Keywords</label>
        <input type="text" id="keywords" placeholder="e.g., project manager, python developer, data analyst">
      </div>
      
      <!-- Settings Summary / Toggle -->
      <div class="settings-toggle-section">
        <div id="settingsSummary" class="settings-summary" style="display: none;">
          <div class="settings-summary-content">
            <span id="summaryText" class="summary-text"></span>
          </div>
          <button class="settings-edit-btn" onclick="toggleSettings()">‚öôÔ∏è Edit Settings</button>
        </div>
        <div id="settingsExpanded" class="settings-expanded">
          <div class="settings-collapse-header" onclick="toggleSettings()" style="display: none; cursor: pointer;">
            <span class="section-title">Search Settings</span>
            <span class="collapse-icon">‚ñ≤</span>
          </div>
      
      <!-- Core Filters - Collapsible Sections -->
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleCollapse(this)">
          <span class="section-title">Experience Level</span>
          <span class="arrow">‚ñº</span>
        </div>
        <div class="collapsible-content">
          <select id="experience">
            <option value="">Any Experience Level</option>
            <option value="1">Internship</option>
            <option value="2">Entry Level</option>
            <option value="3">Associate</option>
            <option value="4">Mid-Senior Level</option>
            <option value="5">Director</option>
            <option value="6">Executive</option>
          </select>
        </div>
      </div>
      
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleCollapse(this)">
          <span class="section-title">Job Type</span>
          <span class="arrow">‚ñº</span>
        </div>
        <div class="collapsible-content">
          <select id="jobType">
            <option value="">Any Job Type</option>
            <option value="F">Full-time</option>
            <option value="P">Part-time</option>
            <option value="C">Contract</option>
            <option value="T">Temporary</option>
            <option value="I">Internship</option>
            <option value="V">Volunteer</option>
          </select>
        </div>
      </div>
      
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleCollapse(this)">
          <span class="section-title">Location</span>
          <span class="arrow">‚ñº</span>
        </div>
        <div class="collapsible-content">
          <select id="location">
            <option value="">Any Location</option>
            <option value="Remote">üåç Remote</option>
          <option value="103644278">United States</option>
          <option value="102277331">San Francisco Bay Area</option>
          <option value="105080838">New York, NY</option>
          <option value="102448103">Los Angeles, CA</option>
          <option value="103112676">Chicago, IL</option>
          <option value="104472865">Austin, TX</option>
          <option value="104116203">Seattle, WA</option>
          <option value="103736294">Denver, CO</option>
          <option value="100293800">Boston, MA</option>
          <option value="102597912">Boulder, CO</option>
          <option value="106233382">San Jose, CA</option>
          <option value="104601127">Houston, TX</option>
          <option value="105146016">Phoenix, AZ</option>
          <option value="104937023">Philadelphia, PA</option>
          <option value="106365502">San Antonio, TX</option>
          <option value="106086138">San Diego, CA</option>
          <option value="100293800">Dallas, TX</option>
          <option value="101915197">Durham, NC</option>
          <option value="105454758">Portland, OR</option>
          <option value="102571732">Atlanta, GA</option>
          <option value="105116571">Nashville, TN</option>
          <option value="105149562">Miami, FL</option>
          <option value="104383890">Washington DC</option>
          <option value="102095887">California</option>
          <option value="102748797">Texas</option>
          <option value="104050827">Florida</option>
          <option value="105763813">Colorado</option>
          <option value="103305169">Washington</option>
          <option value="Other">üìç Other (Enter geoId)</option>
        </select>
        
        <div id="customGeoDiv">
          <label for="customGeoId">LinkedIn geoId:</label>
          <input type="text" id="customGeoId" placeholder="Enter LinkedIn geoId">
        </div>
        </div><!-- End collapsible-content -->
      </div><!-- End collapsible-section -->
      
        </div><!-- End settings-expanded -->
      </div><!-- End settings-toggle-section -->
      
      <!-- Distance Section (Always Visible) -->
      <div class="section" id="distanceDiv">
        <label class="section-title" for="radius">Distance</label>
        <div class="slider-container">
          <div class="slider-value">
            <span id="radiusValue" class="slider-value-label">25 miles</span>
          </div>
          <input type="range" id="radius" class="range-slider" min="0" max="100" value="25" step="5">
          <div class="slider-labels">
            <span style="position: absolute; left: 0%; transform: translateX(0);">0 mi</span>
            <span style="position: absolute; left: 25%; transform: translateX(-50%);">25 mi</span>
            <span style="position: absolute; left: 50%; transform: translateX(-50%);">50 mi</span>
            <span style="position: absolute; left: 75%; transform: translateX(-50%);">75 mi</span>
            <span style="position: absolute; left: 100%; transform: translateX(-100%);">100 mi</span>
          </div>
        </div>
      </div>
      
      <!-- Time & Sort Section -->
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleCollapse(this)">
          <span class="section-title">Time & Sort Options</span>
          <span class="arrow">‚ñº</span>
        </div>
        <div class="collapsible-content">
          <label class="section-title" for="time">Filter by Time</label>
          <select id="time">
            <option value="">Any Time</option>
            <option value="r1800">Past 30 Minutes</option>
            <option value="r3600">Past Hour</option>
            <option value="r7200">Past 2 Hours</option>
            <option value="r86400">Past 24 Hours</option>
            <option value="r604800">Past Week</option>
            <option value="r2592000">Past Month</option>
          </select>
          
          <label class="section-title" for="sort" style="margin-top: 15px;">Sort By</label>
          <select id="sort">
            <option value="DD">Most Recent</option>
            <option value="R">Most Relevant</option>
          </select>
        </div>
      </div>
      
      <!-- Advanced Filters Section -->
      <div class="collapsible-section">
        <div class="collapsible-header" onclick="toggleCollapse(this)">
          <span class="section-title">Advanced Filters</span>
          <span class="arrow">‚ñº</span>
        </div>
        <div class="collapsible-content">
          <div class="toggle-table">
            <div class="toggle-cell">
              <label class="toggle-label">
                <span>Easy Apply</span>
                <div class="toggle-switch">
                  <input type="checkbox" id="toggleEasyApply">
                  <span class="slider"></span>
                </div>
              </label>
            </div>
            <div class="toggle-cell">
              <label class="toggle-label">
                <span>Under 10 Applicants</span>
                <div class="toggle-switch">
                  <input type="checkbox" id="toggleUnder10">
                  <span class="slider"></span>
                </div>
              </label>
            </div>
            <div class="toggle-cell">
              <label class="toggle-label">
                <span>In Your Network</span>
                <div class="toggle-switch">
                  <input type="checkbox" id="toggleNetwork">
                  <span class="slider"></span>
                </div>
              </label>
            </div>
            <div class="toggle-cell">
              <label class="toggle-label">
                <span>FAANG Companies</span>
                <div class="toggle-switch">
                  <input type="checkbox" id="toggleFAANG">
                  <span class="slider"></span>
                </div>
              </label>
            </div>
            <div class="toggle-cell">
              <label class="toggle-label">
                <span>Top Applicant</span>
                <div class="toggle-switch">
                  <input type="checkbox" id="toggleTopApplicant">
                  <span class="slider"></span>
                </div>
              </label>
            </div>
          </div>
        </div>
      </div>
      
      <div class="button-container">
        <button class="primary-btn" onclick="buildUrl()">üîç Search Jobs</button>
      </div>
    </div>
  </div>
  
  <!-- Profile Management Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">My Job Profiles</h2>
        <span class="close" onclick="closeProfileModal()">&times;</span>
      </div>
      <div class="modal-body">
        <!-- Profile List View -->
        <div id="profileListView">
          <div id="profileList" class="profile-list"></div>
          <button class="modal-btn modal-btn-success" onclick="showQuestionnaire()" style="width: 100%;">
            ‚ú® Create New Profile
          </button>
        </div>
        
        <!-- Questionnaire View -->
        <div id="questionnaireView" style="display: none;">
          <div class="progress-bar">
            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
          </div>
          
          <!-- Step 1: Profile Name -->
          <div class="questionnaire-step active" data-step="1">
            <div class="question-title">What would you like to name this profile?</div>
            <input type="text" id="q-profileName" placeholder="e.g., 'project manager' or 'python developer'" style="font-size: 1.05em;">
            <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 10px;">
              üí° This will be your profile name AND your job search keywords
            </p>
          </div>
          
          <!-- Step 2: Experience Level -->
          <div class="questionnaire-step" data-step="2">
            <div class="question-title">What is your experience level?</div>
            <div id="experienceOptions"></div>
          </div>
          
          <!-- Step 3: Job Type -->
          <div class="questionnaire-step" data-step="3">
            <div class="question-title">What job type are you looking for?</div>
            <p style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 15px;">Select all that apply</p>
            <div id="jobTypeOptions"></div>
          </div>
          
          <!-- Step 4: Location -->
          <div class="questionnaire-step" data-step="4">
            <div class="question-title">What is your preferred location?</div>
            <div class="option-card" onclick="selectLocationOption('remote')">
              <div class="option-radio"></div>
              <div class="option-text">üåç Remote (Work from anywhere)</div>
            </div>
            <div class="option-card" onclick="selectLocationOption('custom')">
              <div class="option-radio"></div>
              <div class="option-text">üìç Specific City or State</div>
            </div>
            
            <div id="customLocationInput" style="display: none; margin-top: 20px; padding-bottom: 150px;">
              <label class="section-title">Enter your city or state</label>
              <div class="location-input-container">
                <input type="text" id="q-locationSearch" placeholder="Start typing..." oninput="searchLocations(this.value)">
                <div id="locationSuggestions" class="location-suggestions"></div>
              </div>
            </div>
          </div>
          
          <!-- Step 5: Summary -->
          <div class="questionnaire-step" data-step="5">
            <div class="question-title">Review Your Profile</div>
            <div style="background: var(--bg-primary); padding: 20px; border-radius: 8px; margin: 20px 0;">
              <div style="margin-bottom: 15px;">
                <strong style="color: var(--linkedin-blue);">Profile Name:</strong><br>
                <span id="summary-name"></span>
              </div>
              <div style="margin-bottom: 15px;">
                <strong style="color: var(--linkedin-blue);">Experience Level:</strong><br>
                <span id="summary-experience"></span>
              </div>
              <div style="margin-bottom: 15px;">
                <strong style="color: var(--linkedin-blue);">Job Type:</strong><br>
                <span id="summary-jobtype"></span>
              </div>
              <div>
                <strong style="color: var(--linkedin-blue);">Location:</strong><br>
                <span id="summary-location"></span>
              </div>
            </div>
            <p style="font-size: 0.85em; color: var(--text-secondary); text-align: center;">
              You can edit these settings anytime from the main form
            </p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div id="listViewFooter" style="width: 100%; display: flex; justify-content: flex-end;">
          <button class="modal-btn modal-btn-secondary" onclick="closeProfileModal()">Close</button>
        </div>
        <div id="questionnaireFooter" style="display: none; width: 100%; display: flex; gap: 10px; align-items: center;">
          <button class="modal-btn modal-btn-secondary" onclick="previousStep()" id="prevBtn" style="display: none; flex-shrink: 0;">‚Üê Back</button>
          <div style="flex: 1;"></div>
          <button class="modal-btn modal-btn-primary" onclick="nextStep()" id="nextBtn" style="flex-shrink: 0;">Next ‚Üí</button>
          <button class="modal-btn modal-btn-success" onclick="saveProfile()" id="saveBtn" style="display: none; flex-shrink: 0;">üíæ Save Profile</button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Common Locations Database
    const commonLocations = [
      { name: "New York, NY", geoId: "105080838" },
      { name: "Los Angeles, CA", geoId: "102448103" },
      { name: "Chicago, IL", geoId: "103112676" },
      { name: "Houston, TX", geoId: "104601127" },
      { name: "Phoenix, AZ", geoId: "105146016" },
      { name: "Philadelphia, PA", geoId: "104937023" },
      { name: "San Antonio, TX", geoId: "106365502" },
      { name: "San Diego, CA", geoId: "106086138" },
      { name: "Dallas, TX", geoId: "100293800" },
      { name: "San Jose, CA", geoId: "106233382" },
      { name: "Austin, TX", geoId: "104472865" },
      { name: "San Francisco Bay Area", geoId: "102277331" },
      { name: "Seattle, WA", geoId: "104116203" },
      { name: "Denver, CO", geoId: "103736294" },
      { name: "Boston, MA", geoId: "100293800" },
      { name: "Boulder, CO", geoId: "102597912" },
      { name: "Durham, NC", geoId: "101915197" },
      { name: "Portland, OR", geoId: "105454758" },
      { name: "Atlanta, GA", geoId: "102571732" },
      { name: "Nashville, TN", geoId: "105116571" },
      { name: "Miami, FL", geoId: "105149562" },
      { name: "Washington DC", geoId: "104383890" },
      { name: "California", geoId: "102095887" },
      { name: "Texas", geoId: "102748797" },
      { name: "Florida", geoId: "104050827" },
      { name: "New York", geoId: "105080838" },
      { name: "Colorado", geoId: "105763813" },
      { name: "Washington", geoId: "103305169" },
      { name: "United States", geoId: "103644278" }
    ];
    
    let currentProfileName = null;
    let questionnaireData = {};
    let currentStep = 1;
    const totalSteps = 5;
    
    // Theme
    function toggleTheme() {
      const body = document.body;
      const currentTheme = body.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      body.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }
    
    // Update Profiles Button Text
    function updateProfilesButton() {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const button = document.getElementById('profilesButton');
      if (profiles.length === 0) {
        button.textContent = 'üë§ Create a Profile';
      } else {
        button.textContent = 'üë§ Manage Profiles';
      }
    }
    
    // Toggle Settings Summary/Expanded
    function toggleSettings() {
      const summary = document.getElementById('settingsSummary');
      const expanded = document.getElementById('settingsExpanded');
      const collapseHeader = expanded.querySelector('.settings-collapse-header');
      
      if (summary.style.display === 'none') {
        // Collapse: Show summary, hide expanded
        summary.style.display = 'flex';
        expanded.style.display = 'none';
      } else {
        // Expand: Hide summary, show expanded
        summary.style.display = 'none';
        expanded.style.display = 'block';
        collapseHeader.style.display = 'flex';
      }
    }
    
    // Update Settings Summary Text
    function updateSettingsSummary() {
      const expValue = document.getElementById('experience').value;
      const jobTypeValue = document.getElementById('jobType').value;
      const locationSelect = document.getElementById('location');
      const locationValue = locationSelect.value;
      const locationText = locationSelect.options[locationSelect.selectedIndex]?.text || '';
      
      const expLabels = {
        '1': 'Internship',
        '2': 'Entry Level',
        '3': 'Associate',
        '4': 'Mid-Senior',
        '5': 'Director',
        '6': 'Executive'
      };
      
      const jobTypeLabels = {
        'F': 'Full-time',
        'P': 'Part-time',
        'C': 'Contract',
        'T': 'Temporary',
        'I': 'Internship',
        'V': 'Volunteer'
      };
      
      const parts = [];
      if (expValue) parts.push(expLabels[expValue]);
      if (jobTypeValue) parts.push(jobTypeLabels[jobTypeValue]);
      if (locationValue) parts.push(locationText.replace(/^[üåçüìç]\s*/, ''));
      
      const summaryText = parts.length > 0 ? parts.join(' ‚Ä¢ ') : 'No settings configured';
      document.getElementById('summaryText').textContent = summaryText;
    }
    
    window.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.body.setAttribute('data-theme', savedTheme);
      updateSlider();
      updateProfilesButton();
      loadActiveProfile();
    });
    
    // Distance Slider
    const radiusSlider = document.getElementById('radius');
    const radiusValue = document.getElementById('radiusValue');
    
    function updateSlider() {
      const value = parseInt(radiusSlider.value);
      
      const min = parseInt(radiusSlider.min);
      const max = parseInt(radiusSlider.max);
      const percentage = ((value - min) / (max - min)) * 100;
      
      // Auto-set location to Remote when slider is at 0
      if (value === 0) {
        const locationSelect = document.getElementById('location');
        if (locationSelect.value !== 'Remote') {
          locationSelect.value = 'Remote';
          locationSelect.dispatchEvent(new Event('change'));
        }
      }
      
      // Determine fun message based on distance
      let message = '';
      let displayText = '';
      
      if (value === 0) {
        displayText = 'Remote üèùÔ∏è';
      } else {
        // Determine fun message for non-remote distances
        if (value >= 5 && value <= 10) {
          message = 'The Unicorn ü¶Ñ';
        } else if (value >= 15 && value <= 20) {
          message = 'The easy commute üòé';
        } else if (value >= 25 && value <= 35) {
          message = 'Time to listen to podcasts! üéôÔ∏è';
        } else if (value >= 40 && value <= 50) {
          message = 'The Danger Zone ‚ö†Ô∏è';
        } else if (value >= 55 && value <= 65) {
          message = 'Are you sure? ü•¥';
        } else if (value >= 70 && value <= 75) {
          message = 'This is kinda long ü•µ';
        } else if (value >= 80 && value <= 100) {
          message = 'Run away! ‚ò†Ô∏è';
        }
        
        displayText = message ? `${value} miles - ${message}` : `${value} miles`;
      }
      
      // Update label with display text
      radiusValue.textContent = displayText;
      
      // Smooth label color transition based on distance
      let labelColor;
      if (value === 0) {
        labelColor = '#0073b1'; // LinkedIn blue for remote
      } else if (percentage <= 25) {
        labelColor = '#28a745'; // Green
      } else if (percentage > 25 && percentage <= 50) {
        // Transition from green to yellow
        const progress = (percentage - 25) / 25;
        const r = Math.round(40 + (255 - 40) * progress);
        const g = Math.round(167 + (193 - 167) * progress);
        const b = Math.round(69 + (7 - 69) * progress);
        labelColor = `rgb(${r}, ${g}, ${b})`;
      } else if (percentage > 50 && percentage <= 75) {
        // Transition from yellow to orange
        const progress = (percentage - 50) / 25;
        const r = 255;
        const g = Math.round(193 - (193 - 107) * progress);
        const b = Math.round(7 + (53 - 7) * progress);
        labelColor = `rgb(${r}, ${g}, ${b})`;
      } else {
        // Transition from orange to red
        const progress = (percentage - 75) / 25;
        const r = 255;
        const g = Math.round(107 * (1 - progress));
        const b = Math.round(53 - 53 * progress);
        labelColor = `rgb(${r}, ${g}, ${b})`;
      }
      
      // Update label color
      radiusValue.style.color = labelColor;
      
      // Create smooth gradient
      let gradient;
      if (value === 0) {
        // All grey when at Remote
        gradient = `linear-gradient(to right, #ccc 0%, #ccc 100%)`;
      } else {
        // Gradient from start up to current value, then grey
        const gradientStops = `
          #28a745 0%, 
          #28a745 ${Math.min(percentage, 25)}%, 
          #ffc107 ${Math.min(percentage, 50)}%, 
          #ff6b35 ${Math.min(percentage, 75)}%, 
          #dc3545 ${Math.min(percentage, 100)}%, 
          #ccc ${percentage}%, 
          #ccc 100%
        `;
        gradient = `linear-gradient(to right, ${gradientStops})`;
      }
      
      radiusSlider.style.background = gradient;
    }
    
    radiusSlider.addEventListener('input', updateSlider);
    
    // Collapsible
    function toggleCollapse(header) {
      header.classList.toggle('active');
      const content = header.nextElementSibling;
      content.classList.toggle('active');
    }
    
    // Location
    document.getElementById('location').addEventListener('change', function () {
      const isOther = this.value === 'Other';
      const isRemote = this.value === 'Remote';
      document.getElementById('customGeoDiv').style.display = isOther ? 'block' : 'none';
      document.getElementById('distanceDiv').style.display = isRemote ? 'none' : 'block';
    });
    
    // Clear Form
    function clearForm() {
      document.getElementById('keywords').value = '';
      document.getElementById('experience').value = '';
      document.getElementById('jobType').value = '';
      document.getElementById('location').value = '';
      document.getElementById('radius').value = '25';
      document.getElementById('customGeoId').value = '';
      document.getElementById('time').value = '';
      document.getElementById('sort').value = 'DD';
      document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
      document.getElementById('customGeoDiv').style.display = 'none';
      document.getElementById('distanceDiv').style.display = 'block';
      updateSlider();
      
      // Expand settings when cleared
      document.getElementById('settingsSummary').style.display = 'none';
      document.getElementById('settingsExpanded').style.display = 'block';
      document.querySelector('.settings-collapse-header').style.display = 'none';
    }
    
    // Build URL
    function buildUrl() {
      const keywords = encodeURIComponent(document.getElementById('keywords').value.trim());
      const expValue = document.getElementById('experience').value;
      let f_E_param = expValue ? `&f_E=${encodeURIComponent(expValue)}` : "";
      
      const jobTypeValue = document.getElementById('jobType').value;
      const f_JT_param = jobTypeValue ? `&f_JT=${jobTypeValue}` : "";
      
      const locationSelect = document.getElementById('location');
      const locationValue = locationSelect.value;
      const locationText = locationSelect.options[locationSelect.selectedIndex]?.text.replace(/^[üåçüìç]\s*/, '');
      let geoId = locationValue;
      let f_WT_param = "";
      
      if (locationValue === "Remote") {
        geoId = "";
        f_WT_param = "&f_WT=2";
      } else if (locationValue === "Other") {
        geoId = document.getElementById('customGeoId').value.trim();
        f_WT_param = "&f_WT=1%2C3";
      } else if (locationValue !== "") {
        f_WT_param = "&f_WT=1%2C3";
      }
      
      const radiusValue = document.getElementById('radius').value;
      // Don't include distance parameter if slider is at 0 (Remote)
      const distanceParam = (radiusValue && radiusValue !== '0') ? `&distance=${radiusValue}` : '';
      const locationParam = (locationValue && locationValue !== "Remote" && locationValue !== "Other") 
        ? `&location=${encodeURIComponent(locationText)}` 
        : '';
      
      const time = document.getElementById('time').value;
      const sort = document.getElementById('sort').value;
      
      const f_AL_param = document.getElementById('toggleEasyApply').checked ? "&f_AL=true" : "";
      const f_EA_param = document.getElementById('toggleUnder10').checked ? "&f_EA=true" : "";
      const f_JIYN_param = document.getElementById('toggleNetwork').checked ? "&f_JIYN=true" : "";
      const f_C_param = document.getElementById('toggleFAANG').checked 
        ? "&f_C=" + encodeURIComponent("1441,10667,1586,8074624,165158,162479") 
        : "";
      const f_JC_param = document.getElementById('toggleTopApplicant').checked 
        ? "&f_JC=(0%2Clisystem%2Ctop-applicant-jobs)" 
        : "";
      
      const timeParam = time ? `f_TPR=${time}` : "";
      const geoParam = geoId ? `&geoId=${geoId}` : "";
      
      const finalUrl = `https://www.linkedin.com/jobs/search/?${timeParam}${geoParam}${distanceParam}${f_C_param}${f_EA_param}${f_AL_param}${f_JIYN_param}${f_JC_param}${f_WT_param}${f_E_param}${f_JT_param}&keywords=${keywords}${locationParam}&origin=JOB_SEARCH_PAGE_LOCATION_AUTOCOMPLETE&refresh=true&sortBy=${sort}`;
      
      // Try to open LinkedIn app on mobile, fallback to browser
      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      
      if (isMobile) {
        // Try app deep link first
        window.location.href = finalUrl;
      } else {
        // Desktop: open in new tab
        const newWindow = window.open(finalUrl, '_blank');
        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
          window.location.href = finalUrl;
        }
      }
    }
    
    // Profile Modal
    function openProfileModal() {
      document.getElementById('profileModal').style.display = 'block';
      showProfileList();
      loadProfiles();
    }
    
    function closeProfileModal() {
      document.getElementById('profileModal').style.display = 'none';
      resetQuestionnaire();
    }
    
    window.onclick = function(event) {
      const modal = document.getElementById('profileModal');
      if (event.target == modal) {
        closeProfileModal();
      }
    }
    
    function showProfileList() {
      document.getElementById('profileListView').style.display = 'block';
      document.getElementById('questionnaireView').style.display = 'none';
      document.getElementById('listViewFooter').style.display = 'flex';
      document.getElementById('questionnaireFooter').style.display = 'none';
      document.getElementById('modalTitle').textContent = 'My Job Profiles';
    }
    
    function showQuestionnaire() {
      document.getElementById('profileListView').style.display = 'none';
      document.getElementById('questionnaireView').style.display = 'block';
      document.getElementById('listViewFooter').style.display = 'none';
      document.getElementById('questionnaireFooter').style.display = 'flex';
      document.getElementById('modalTitle').textContent = 'Create New Profile';
      resetQuestionnaire();
      populateQuestionnaireOptions();
      updateProgress();
    }
    
    function resetQuestionnaire() {
      currentStep = 1;
      questionnaireData = {};
      document.querySelectorAll('.questionnaire-step').forEach((step, index) => {
        step.classList.toggle('active', index === 0);
      });
      document.getElementById('q-profileName').value = '';
      document.querySelectorAll('.option-card').forEach(card => card.classList.remove('selected'));
      updateNavigationButtons();
      updateProgress();
    }
    
    function populateQuestionnaireOptions() {
      const expOptions = [
        { value: '1', label: 'Internship', desc: 'Student or recent graduate' },
        { value: '2', label: 'Entry Level', desc: '0-2 years experience' },
        { value: '3', label: 'Associate', desc: '2-5 years experience' },
        { value: '4', label: 'Mid-Senior Level', desc: '5-10 years experience' },
        { value: '5', label: 'Director', desc: 'Leadership role' },
        { value: '6', label: 'Executive', desc: 'C-level or VP' }
      ];
      
      document.getElementById('experienceOptions').innerHTML = expOptions.map(opt => `
        <div class="option-card ${questionnaireData.experience === opt.value ? 'selected' : ''}" onclick="selectExperience('${opt.value}')">
          <div class="option-radio"></div>
          <div style="flex: 1;">
            <div class="option-text">${opt.label}</div>
            <div style="font-size: 0.8em; color: var(--text-secondary); margin-top: 3px;">${opt.desc}</div>
          </div>
        </div>
      `).join('');
      
      const jobTypeOptions = [
        { value: 'F', label: 'Full-time' },
        { value: 'P', label: 'Part-time' },
        { value: 'C', label: 'Contract' },
        { value: 'T', label: 'Temporary' },
        { value: 'I', label: 'Internship' },
        { value: 'V', label: 'Volunteer' }
      ];
      
      document.getElementById('jobTypeOptions').innerHTML = jobTypeOptions.map(opt => {
        const isSelected = questionnaireData.jobTypes && questionnaireData.jobTypes.includes(opt.value);
        return `
          <div class="option-card ${isSelected ? 'selected' : ''}" onclick="toggleJobType('${opt.value}', this)">
            <div class="option-radio"></div>
            <div class="option-text">${opt.label}</div>
          </div>
        `;
      }).join('');
      
      // Pre-select location if editing
      if (questionnaireData.locationType) {
        setTimeout(() => {
          const locationCards = document.querySelectorAll('#questionnaireView .questionnaire-step[data-step="4"] .option-card');
          if (questionnaireData.locationType === 'remote') {
            locationCards[0]?.classList.add('selected');
            document.getElementById('customLocationInput').style.display = 'none';
          } else if (questionnaireData.locationType === 'custom') {
            locationCards[1]?.classList.add('selected');
            document.getElementById('customLocationInput').style.display = 'block';
            document.getElementById('q-locationSearch').value = questionnaireData.location || '';
          }
        }, 100);
      }
    }
    
    function selectExperience(value) {
      questionnaireData.experience = value;
      document.querySelectorAll('#experienceOptions .option-card').forEach(card => {
        card.classList.remove('selected');
      });
      event.currentTarget.classList.add('selected');
    }
    
    function toggleJobType(value, element) {
      if (!questionnaireData.jobTypes) {
        questionnaireData.jobTypes = [];
      }
      const index = questionnaireData.jobTypes.indexOf(value);
      if (index > -1) {
        questionnaireData.jobTypes.splice(index, 1);
        element.classList.remove('selected');
      } else {
        questionnaireData.jobTypes.push(value);
        element.classList.add('selected');
      }
    }
    
    function selectLocationOption(type) {
      questionnaireData.locationType = type;
      document.querySelectorAll('#questionnaireView .questionnaire-step[data-step="4"] .option-card').forEach(card => {
        card.classList.remove('selected');
      });
      event.currentTarget.classList.add('selected');
      
      if (type === 'remote') {
        questionnaireData.location = 'Remote';
        questionnaireData.geoId = '';
        document.getElementById('customLocationInput').style.display = 'none';
      } else {
        document.getElementById('customLocationInput').style.display = 'block';
      }
    }
    
    function searchLocations(query) {
      const suggestions = document.getElementById('locationSuggestions');
      if (!query || query.length < 2) {
        suggestions.classList.remove('active');
        return;
      }
      const matches = commonLocations.filter(loc => 
        loc.name.toLowerCase().includes(query.toLowerCase())
      ).slice(0, 8);
      if (matches.length > 0) {
        suggestions.innerHTML = matches.map(loc => `
          <div class="location-suggestion-item" onclick="selectLocation('${loc.name}', '${loc.geoId}')">
            ${loc.name}
          </div>
        `).join('');
        suggestions.classList.add('active');
      }
    }
    
    function selectLocation(name, geoId) {
      questionnaireData.location = name;
      questionnaireData.geoId = geoId;
      document.getElementById('q-locationSearch').value = name;
      document.getElementById('locationSuggestions').classList.remove('active');
    }
    
    function updateProgress() {
      const progress = (currentStep / totalSteps) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }
    
    function updateNavigationButtons() {
      document.getElementById('prevBtn').style.display = currentStep > 1 ? 'block' : 'none';
      document.getElementById('nextBtn').style.display = currentStep < totalSteps ? 'block' : 'none';
      document.getElementById('saveBtn').style.display = currentStep === totalSteps ? 'block' : 'none';
    }
    
    function nextStep() {
      if (currentStep === 1) {
        const profileName = document.getElementById('q-profileName').value.trim();
        if (!profileName) {
          alert('Please enter a profile name');
          return;
        }
        questionnaireData.name = profileName;
      } else if (currentStep === 2 && !questionnaireData.experience) {
        alert('Please select an experience level');
        return;
      } else if (currentStep === 3 && (!questionnaireData.jobTypes || questionnaireData.jobTypes.length === 0)) {
        alert('Please select at least one job type');
        return;
      } else if (currentStep === 4 && !questionnaireData.locationType) {
        alert('Please select a location preference');
        return;
      } else if (currentStep === 4 && questionnaireData.locationType === 'custom' && !questionnaireData.location) {
        alert('Please select a location');
        return;
      }
      
      if (currentStep < totalSteps) {
        document.querySelector(`.questionnaire-step[data-step="${currentStep}"]`).classList.remove('active');
        currentStep++;
        document.querySelector(`.questionnaire-step[data-step="${currentStep}"]`).classList.add('active');
        if (currentStep === totalSteps) {
          displaySummary();
        }
        updateProgress();
        updateNavigationButtons();
      }
    }
    
    function previousStep() {
      if (currentStep > 1) {
        document.querySelector(`.questionnaire-step[data-step="${currentStep}"]`).classList.remove('active');
        currentStep--;
        document.querySelector(`.questionnaire-step[data-step="${currentStep}"]`).classList.add('active');
        updateProgress();
        updateNavigationButtons();
      }
    }
    
    function displaySummary() {
      document.getElementById('summary-name').textContent = questionnaireData.name;
      const expText = document.querySelector(`#experienceOptions .option-card.selected .option-text`)?.textContent || 'Not selected';
      document.getElementById('summary-experience').textContent = expText;
      
      const jobTypeLabels = {'F': 'Full-time', 'P': 'Part-time', 'C': 'Contract', 'T': 'Temporary', 'I': 'Internship', 'V': 'Volunteer'};
      let jobTypeText = 'Not selected';
      if (questionnaireData.jobTypes && questionnaireData.jobTypes.length > 0) {
        const types = questionnaireData.jobTypes
          .filter(jt => jt && jobTypeLabels[jt]) // Filter out empty/undefined values
          .map(jt => jobTypeLabels[jt]);
        jobTypeText = types.length > 0 ? types.join(', ') : 'Not selected';
      }
      document.getElementById('summary-jobtype').textContent = jobTypeText;
      
      document.getElementById('summary-location').textContent = questionnaireData.location || 'Not selected';
    }
    
    function saveProfile() {
      const profile = {
        name: questionnaireData.name,
        data: {
          experience: questionnaireData.experience,
          jobTypes: questionnaireData.jobTypes || [],
          location: questionnaireData.locationType === 'remote' ? 'Remote' : questionnaireData.geoId,
          locationName: questionnaireData.location,
          keywords: questionnaireData.name // Store profile name as keywords
        },
        created: Date.now()
      };
      
      let profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      
      if (questionnaireData.isEditing) {
        // Update existing profile
        profiles[questionnaireData.editIndex] = profile;
      } else {
        // Check for duplicate names when creating new
        const existingIndex = profiles.findIndex(p => p.name === profile.name);
        if (existingIndex !== -1) {
          profiles[existingIndex] = profile;
        } else {
          profiles.push(profile);
        }
      }
      
      localStorage.setItem('jobProfiles', JSON.stringify(profiles));
      loadProfileByName(profile.name);
      closeProfileModal();
      
      const action = questionnaireData.isEditing ? 'updated' : 'created';
      alert(`‚úÖ Profile "${profile.name}" ${action} and activated!`);
    }
    
    function loadProfiles() {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const profileList = document.getElementById('profileList');
      
      // Update button text based on whether profiles exist
      updateProfilesButton();
      
      if (profiles.length === 0) {
        profileList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <p><strong>No profiles yet</strong></p>
            <p style="font-size: 0.9em;">Create a profile to save your preferences</p>
          </div>
        `;
        return;
      }
      
      profileList.innerHTML = profiles.map((profile, index) => {
        const isActive = currentProfileName === profile.name;
        const expMap = {'1': 'Internship', '2': 'Entry Level', '3': 'Associate', '4': 'Mid-Senior', '5': 'Director', '6': 'Executive'};
        const exp = expMap[profile.data.experience] || 'Any';
        const jobTypeLabels = {'F': 'Full-time', 'P': 'Part-time', 'C': 'Contract', 'T': 'Temporary', 'I': 'Internship', 'V': 'Volunteer'};
        const jobTypes = profile.data.jobTypes?.map(jt => jobTypeLabels[jt]).join(', ') || 'Any';
        const loc = profile.data.locationName || 'Any';
        
        return `
          <div class="profile-item ${isActive ? 'active' : ''}" onclick="loadProfileByIndex(${index})">
            <div class="profile-info">
              <div class="profile-name">${isActive ? 'üéØ ' : ''}${profile.name}</div>
              <div class="profile-details">${loc} ‚Ä¢ ${exp} ‚Ä¢ ${jobTypes}</div>
            </div>
            <div class="profile-actions">
              <button class="profile-action-btn load" onclick="event.stopPropagation(); loadProfileByIndex(${index}); closeProfileModal();">
                üì• Load
              </button>
              <button class="profile-action-btn edit" onclick="event.stopPropagation(); editProfile(${index})">
                ‚úèÔ∏è Edit
              </button>
              <button class="profile-action-btn delete" onclick="event.stopPropagation(); deleteProfile(${index})">
                üóëÔ∏è
              </button>
            </div>
          </div>
        `;
      }).join('');
    }
    
    function loadProfileByIndex(index) {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      if (profiles[index]) {
        loadProfileByName(profiles[index].name);
      }
    }
    
    function loadProfileByName(name) {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const profile = profiles.find(p => p.name === name);
      if (!profile) return;
      
      // Set keywords from profile (only the keywords, not location)
      document.getElementById('keywords').value = profile.data.keywords || profile.name;
      
      // Set experience level
      document.getElementById('experience').value = profile.data.experience || '';
      
      // Set job type (now a dropdown, take first value if array exists for backwards compatibility)
      const jobType = Array.isArray(profile.data.jobTypes) && profile.data.jobTypes.length > 0 
        ? profile.data.jobTypes[0] 
        : (profile.data.jobType || '');
      document.getElementById('jobType').value = jobType;
      
      // Handle location
      if (profile.data.location === 'Remote') {
        document.getElementById('location').value = 'Remote';
        document.getElementById('distanceDiv').style.display = 'none';
      } else if (profile.data.location) {
        // Check if the geoId exists in the dropdown
        const locationOption = document.querySelector(`#location option[value="${profile.data.location}"]`);
        if (locationOption) {
          document.getElementById('location').value = profile.data.location;
        } else {
          // Use "Other" and set custom geoId
          document.getElementById('location').value = 'Other';
          document.getElementById('customGeoId').value = profile.data.location;
          document.getElementById('customGeoDiv').style.display = 'block';
        }
        document.getElementById('location').dispatchEvent(new Event('change'));
      }
      
      currentProfileName = name;
      localStorage.setItem('activeProfile', name);
      updateProfileBanner();
      loadProfiles();
      
      // Update and show settings summary
      updateSettingsSummary();
      document.getElementById('settingsSummary').style.display = 'flex';
      document.getElementById('settingsExpanded').style.display = 'none';
    }
    
    function deleteProfile(index) {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const profileName = profiles[index].name;
      if (confirm(`Delete profile "${profileName}"?`)) {
        if (currentProfileName === profileName) {
          clearProfile();
        }
        profiles.splice(index, 1);
        localStorage.setItem('jobProfiles', JSON.stringify(profiles));
        loadProfiles();
      }
    }
    
    function editProfile(index) {
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const profile = profiles[index];
      if (!profile) return;
      
      // Switch to questionnaire view
      showQuestionnaire();
      
      // Pre-populate the questionnaire with existing data
      questionnaireData = {
        name: profile.name,
        experience: profile.data.experience,
        jobTypes: profile.data.jobTypes || [],
        location: profile.data.locationName,
        geoId: profile.data.location,
        locationType: profile.data.location === 'Remote' ? 'remote' : 'custom'
      };
      
      // Set profile name
      document.getElementById('q-profileName').value = profile.name;
      
      // Mark as editing (will overwrite on save)
      questionnaireData.isEditing = true;
      questionnaireData.editIndex = index;
    }
    
    function quickSearch(type) {
      const keywords = encodeURIComponent(document.getElementById('keywords').value.trim());
      const expValue = document.getElementById('experience').value;
      let f_E_param = expValue ? `&f_E=${encodeURIComponent(expValue)}` : "";
      
      const jobTypeValue = document.getElementById('jobType').value;
      const f_JT_param = jobTypeValue ? `&f_JT=${jobTypeValue}` : "";
      
      const locationSelect = document.getElementById('location');
      const locationValue = locationSelect.value;
      const locationText = locationSelect.options[locationSelect.selectedIndex]?.text.replace(/^[üåçüìç]\s*/, '');
      let geoId = locationValue;
      let f_WT_param = "";
      
      if (locationValue === "Remote") {
        geoId = "";
        f_WT_param = "&f_WT=2";
      } else if (locationValue === "Other") {
        geoId = document.getElementById('customGeoId').value.trim();
        f_WT_param = "&f_WT=1%2C3";
      } else if (locationValue !== "") {
        f_WT_param = "&f_WT=1%2C3";
      }
      
      const radiusValue = document.getElementById('radius').value;
      // Don't include distance parameter if slider is at 0 (Remote)
      const distanceParam = (radiusValue && radiusValue !== '0') ? `&distance=${radiusValue}` : '';
      const locationParam = (locationValue && locationValue !== "Remote" && locationValue !== "Other") 
        ? `&location=${encodeURIComponent(locationText)}` 
        : '';
      
      const sort = document.getElementById('sort').value || 'DD';
      
      // Base filters from form
      const f_AL_param = document.getElementById('toggleEasyApply').checked ? "&f_AL=true" : "";
      const f_JIYN_param = document.getElementById('toggleNetwork').checked ? "&f_JIYN=true" : "";
      const f_C_param = document.getElementById('toggleFAANG').checked 
        ? "&f_C=" + encodeURIComponent("1441,10667,1586,8074624,165158,162479") 
        : "";
      
      // Quick action specific parameters
      let timeParam = "";
      let f_EA_param = "";
      let f_JC_param = "";
      
      switch(type) {
        case '24h':
          timeParam = "f_TPR=r86400";
          break;
        case '8h':
          timeParam = "f_TPR=r28800";
          break;
        case 'under10':
          f_EA_param = "&f_EA=true";
          timeParam = "f_TPR=r604800"; // Past week
          break;
        case 'topApplicant':
          f_JC_param = "&f_JC=(0%2Clisystem%2Ctop-applicant-jobs)";
          break;
      }
      
      const geoParam = geoId ? `&geoId=${geoId}` : "";
      
      const finalUrl = `https://www.linkedin.com/jobs/search/?${timeParam}${geoParam}${distanceParam}${f_C_param}${f_EA_param}${f_AL_param}${f_JIYN_param}${f_JC_param}${f_WT_param}${f_E_param}${f_JT_param}&keywords=${keywords}${locationParam}&origin=JOB_SEARCH_PAGE_LOCATION_AUTOCOMPLETE&refresh=true&sortBy=${sort}`;
      
      // Try to open LinkedIn app on mobile, fallback to browser
      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      
      if (isMobile) {
        // Try app deep link first
        window.location.href = finalUrl;
      } else {
        // Desktop: open in new tab
        const newWindow = window.open(finalUrl, '_blank');
        if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
          window.location.href = finalUrl;
        }
      }
    }
    
    function clearProfile() {
      currentProfileName = null;
      localStorage.removeItem('activeProfile');
      updateProfileBanner();
      loadProfiles();
      
      // Also clear the form
      clearForm();
    }
    
    function editActiveProfile() {
      if (!currentProfileName) return;
      
      const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
      const profileIndex = profiles.findIndex(p => p.name === currentProfileName);
      
      if (profileIndex !== -1) {
        // Open the modal first
        openProfileModal();
        // Then edit the profile
        editProfile(profileIndex);
      }
    }
    
    function loadActiveProfile() {
      const activeName = localStorage.getItem('activeProfile');
      if (activeName) {
        loadProfileByName(activeName);
      }
    }
    
    function updateProfileBanner() {
      const banner = document.getElementById('profileBanner');
      const details = document.getElementById('profileBannerDetails');
      
      if (currentProfileName) {
        const profiles = JSON.parse(localStorage.getItem('jobProfiles') || '[]');
        const profile = profiles.find(p => p.name === currentProfileName);
        if (profile) {
          const expMap = {'1': 'Internship', '2': 'Entry Level', '3': 'Associate', '4': 'Mid-Senior', '5': 'Director', '6': 'Executive'};
          const exp = expMap[profile.data.experience] || 'Any';
          details.textContent = `${profile.name} ‚Ä¢ ${profile.data.locationName || 'Any'} ‚Ä¢ ${exp}`;
          banner.style.display = 'flex';
        }
      } else {
        banner.style.display = 'none';
      }
    }
  </script>
</body>
</html>
